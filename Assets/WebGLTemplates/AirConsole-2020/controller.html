
<html>
<head>
  <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
  <link rel="stylesheet" type="text/css" href="shared_styles.css">
  <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script type="text/javascript" src="https://www.airconsole.com/api/airconsole-1.7.0.js"></script>
  <script type="text/javascript" src="../airconsole-view-manager.js"></script>
  
  <script type="text/javascript">
    var airconsole = new AirConsole({"orientation": "landscape"});
    var vm = null;

    var startConfirmed = false;

    function App() {

      /* JavaScript / Functionality. Add functions and evens here */

      airconsole.onReady = function(code) {
        vm = new AirConsoleViewManager(airconsole);
        vm.controllersShow('Start');
      };

      airconsole.onMessage = function(from, data) {
          console.log("onMessage", from, data);
          
          interpretMessage(data);
      };

      App.prototype.sendMessageToScreen = function (msg) {
          console.log("button press");
          airconsole.message(AirConsole.SCREEN, { "action": msg });
          airconsole.vibrate(100);
      };

      App.prototype.startGameConfirm = function (msg) {
          if(msg == "confirm" && !startConfirmed){
              document.getElementById("start-button").classList.add("deactive");
              airconsole.message(AirConsole.SCREEN, { "action": msg });
              startConfirmed = true
          }
      }

      function interpretMessage(string){
          var messages = string.split(";");

          switch(messages[0]){
            case "Tutorial":
              if(messages[1] == "Start"){
                  vm.controllersShow("ingame");
              }
              else if(messages[1] == "Cloth"){
                  document.getElementById("cloth-image").style.backgroundImage = "url(Tutorial" + messages[2] + "/" + messages[3] + ".png)";
                  document.getElementById("cloth-text").innerHTML = messages[4];
              }
          }
      }

      /*
       * Here we are adding support for mouse events manually.
       * --> WE STRONGLY ENCOURAGE YOU TO USE THE AIRCONSOLE CONTROLS LIBRARY
       * WHICH IS EVEN BETTER (BUT WE DONT WANT TO BLOAT THE CODE HERE).
       * https://github.com/AirConsole/airconsole-controls/
       * 
       * DO NOT USE ONCLICK HANDLERS.
       * THEY ADD A 200MS DELAY!
       */
      if (!("ontouchstart" in document.createElement("div"))) {
        var elements = document.getElementsByTagName("*");
        for (var i = 0; i < elements.length; ++i) {
          var element = elements[i];
          var ontouchstart = element.getAttribute("ontouchstart");
          if (ontouchstart) {
            element.setAttribute("onmousedown", ontouchstart);
          }
          var ontouchend = element.getAttribute("ontouchend");
          if (ontouchend) {
            element.setAttribute("onmouseup", ontouchend);
          }
        }
      }     
    }
  </script>

</head>
<body onload="window.app = new App()">
  <!-- Add your HTML elements here -->
    <!--<div id="interact-button" ontouchstart="window.app.sendMessageToScreen('interact')"></div>-->

    <div id="start" class="view default-view">
      <div id = "start-button" class="Start-button" ontouchstart="window.app.startGameConfirm('confirm')"> Ready </div>
      <div id="Start-text"> Ready to save the planet? </div>
    </div>
  
    <div id="ingame" class="view">
      <div id="cloth-image"></div>
      <div id="cloth-text"></div>
      <div id="tutorial-hint-text">Select the number to Rank:</div>
      <div class="Tutorial button-one" ontouchstart="window.app.sendMessageToScreen('1')"> 1 </div>
      <div class="Tutorial button-two" ontouchstart="window.app.sendMessageToScreen('2')"> 2 </div>
      <div class="Tutorial button-three" ontouchstart="window.app.sendMessageToScreen('3')"> 3 </div>
      <div class="Tutorial button-four" ontouchstart="window.app.sendMessageToScreen('4')"> 4 </div>
    </div>

</body>
</html>